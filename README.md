# Kotlin Math Utils (KMU)

Библиотека математических функций и объектов. Библиотека предназначается для разработки в области компьютерной графики и процедурной генерации.

Реализация линейной алгебры сделана таким образом, что может быть удобно использована совместно с [LWJGL](https://github.com/LWJGL/lwjgl3) (OpenGL). Многие методы и функции портированы из [GLM](https://github.com/g-truc/glm) и полностью соответствуют методам GLM, однако полного соответствия достичь не удалось.

## Features

### Вектора

Поддерживаемые виды векторов:

+ Двухкомпонентные вектора вида (x, y)
+ Трехкомпонентные вектора вида (x, y, z)

Поддерживаемые типы данных векторов:

+ Float (float32)
+ Double (float64)
+ Int (int32)
+ Long (int64)

Поддерживаемые операции над векторами:

+ Базовые арифметические операции (сложение, умножение, вычитание, векторное и скалярное произведение векторов)
+ Базовые арифметические операции со скалярами (сложение, умножение, вычитание, произведение векторов и скаляров)
+ Вычисление длины вектора (length)
+ Вычисление расстояния между двумя точками (distance)
+ Нормализация векторов (normalize)

На данный момент поддерживается только организация векторов в памяти только подходом AoS. В будущем планируется поддержка подхода SoA.

### Матрицы

Имеется экспериментальная поддержка, но она не вынесена в кодогенерацию

### Шумы

Поддерживаемые шумы разделяются на несколько отдельных типов. В зависимости от типа шума зависят типы исходных и продуцируемых отображаемых величин. Первая категория шумов: Noise***N***D - производит отображение исходного вектора размерности ***N*** на некий случайный скаляр. Вторая категория шумов: Field***N***D - производит отображение исходного вектора размерности ***N*** на другой случайный вектор размерности ***N***.

Поддерживаются декораторы шума для более точной настройки шумов.

#### Noise2D

+ Классический шум Перлина (Perlin Noise).
+ Многооктавный шум (Fractal Brownian Motion).
+ Клеточный шум или Шум Ворли (Worley Noise / Cellular Noise).
+ Gold Noise - простейший шум, применяемый как основа для других шумов. Крайне быстр в вычислении.

#### Field2D

+ Вихревой шум (Curl Noise).

### Обертки над ГСПЧ

Для удобства использования библиотеки над всеми применяемыми ГСПЧ используется обертка. На данный момент оборачивается только стандартный ГСПЧ JDK.

### Геометрические примитивы

Имеется экспериментальная поддержка, но она не вынесена в кодогенерацию

## Demo

В коде имеется модуль Demo, который включает в себя программу генерации изображений-примеров для различных шумов с различными параметрами. Для запуска генерации изображений шумов:

```bash
./gradlew :demo:run
```

После выполнения программы будут сгенерированы PNG-изображения с примерами сгенерированных шумов.

## Kpoet-generation

Модуль генерации исходного кода операций над векторами. Автоматически генерирует всю кодовую базу для типов векторов: сами типы, арифметические операции, операции с использованием буфферов и т. д. Такой подход позволяет достичь максимальной однородности кода в условиях ограничений дженериков Java.

Для генерации необходимо просто запустить Main соответствующего модуля любым из доступных способов. Так как это сугубо утилитарный модуль, сборка и использование которого не предполагается за рамками разработки KMU, настройка была вынесена в отдельный файл исходного кода - GenerationConstants.kt.
